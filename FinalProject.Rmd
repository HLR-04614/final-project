---
title: "Final_Project"
author: "Heather Richard, Beth Davis"
date: "2022-11-30"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library()

data<-read.csv('~/Desktop/Heather.Richard/EvoEcoTheory/metalsdata.csv')
head(data)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
library(ggplot2)
library(hillR)
library(reshape2)

ggplot(data, aes(rank, Aluminum27)) +
  geom_line()+
  facet_grid(Location~Material)
```
##Melting the dataframe with reshape2 to make it work

```{r}
data2<-melt(data, id = c("Number","Sample","Weight","Unbrushed", "Location","Material","Day.deploy","Optical.density","Replicate")) 
head(data2)
```

#Try again
```{r}
ggplot(data2, aes(value, variable)) +
  scale_x_log10() +
  geom_line()+
  facet_grid(Location~Material)
```




## From lectures

equation 3a
qD = ()
p_i is the relative abundance of species (scales sums to 1) similar to song_sad but different. where for each species p_i is the number of plays for that species/song
q is the order of the hill number. q cannot be exactly 1
to get Hill numbers as q gets close to 1 use: q<-1-E-5 ##don't get this part
can also use the equation 3b from the hill paper


```{r pressure, echo=TRUE}
songs_sad<-data2$value
q<- 2
songs_relabund<- songs_sad/sum(songs_sad)
head(songs_relabund)
sum(songs_relabund)
```


now raise relative abundance of species to the power of q and take the sum of all values\

```{r}
songs_relabund_toq<- songs_relabund^q
head(songs_relabund_toq)
```


```{r}
summed_relabund<-sum(songs_relabund_toq)
summed_relabund_exponent <- summed_relabund ^(1/1-q)
summed_relabund_exponent
```

In some cases it breaks, but for the most part this command below does what we did manually in the steps above

```{r}
hillR::hill_taxa(songs_sad, q)
```

